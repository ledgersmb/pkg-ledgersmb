//>>built
define("dijit/_base/focus",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/topic","dojo/_base/window","../focus","../selection","../main"],function(e,r,t,a,i,d,l,o){var n={_curFocus:null,_prevFocus:null,isCollapsed:function(){return o.getBookmark().isCollapsed},getBookmark:function(){return(i.global==window?l:new l.SelectionManager(i.global)).getBookmark()},moveToBookmark:function(e){return(i.global==window?l:new l.SelectionManager(i.global)).moveToBookmark(e)},getFocus:function(e,t){var a=!d.curNode||e&&r.isDescendant(d.curNode,e.domNode)?o._prevFocus:d.curNode;return{node:a,bookmark:a&&a==d.curNode&&i.withGlobal(t||i.global,o.getBookmark),openedForWindow:t}},_activeStack:[],registerIframe:function(e){return d.registerIframe(e)},unregisterIframe:function(e){e&&e.remove()},registerWin:function(e,r){return d.registerWin(e,r)},unregisterWin:function(e){e&&e.remove()}};return d.focus=function(e){if(e){var r="node"in e?e.node:e,t=e.bookmark,a=e.openedForWindow,l=!!t&&t.isCollapsed;if(r){var n="iframe"==r.tagName.toLowerCase()?r.contentWindow:r;if(n&&n.focus)try{n.focus()}catch(e){}d._onFocusNode(r)}if(t&&i.withGlobal(a||i.global,o.isCollapsed)&&!l){a&&a.focus();try{i.withGlobal(a||i.global,o.moveToBookmark,null,[t])}catch(e){}}}},d.watch("curNode",function(e,r,t){o._curFocus=t,o._prevFocus=r,t&&a.publish("focusNode",t)}),d.watch("activeStack",function(e,r,t){o._activeStack=t}),d.on("widget-blur",function(e,r){a.publish("widgetBlur",e,r)}),d.on("widget-focus",function(e,r){a.publish("widgetFocus",e,r)}),t.mixin(o,n),o});//# sourceMappingURL=focus.js.map