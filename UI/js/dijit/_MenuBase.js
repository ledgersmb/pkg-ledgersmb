//>>built
define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./registry","./_Widget","./_CssStateMixin","./_KeyNavContainer","./_TemplatedMixin"],function(e,r,t,a,i,d,l,o,n,s,f,m,v,u,h){return r("dijit._MenuBase",[m,h,u,v],{selected:null,_setSelectedAttr:function(e){this.selected!=e&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),e&&e._setSelected(!0),this._set("selected",e))},activated:!1,_setActivatedAttr:function(e){i.toggle(this.domNode,"dijitMenuActive",e),i.toggle(this.domNode,"dijitMenuPassive",!e),this._set("activated",e)},parentMenu:null,popupDelay:500,passivePopupDelay:1/0,autoFocus:!1,childSelector:function(e){var r=f.byNode(e);return e.parentNode==this.containerNode&&r&&r.focus},postCreate:function(){var e=this,r="string"==typeof this.childSelector?this.childSelector:d.hitch(this,"childSelector");this.own(o(this.containerNode,o.selector(r,l.enter),function(){e.onItemHover(f.byNode(this))}),o(this.containerNode,o.selector(r,l.leave),function(){e.onItemUnhover(f.byNode(this))}),o(this.containerNode,o.selector(r,s),function(r){e.onItemClick(f.byNode(this),r),r.stopPropagation()}),o(this.containerNode,o.selector(r,"focusin"),function(){e._onItemFocus(f.byNode(this))})),this.inherited(arguments)},onKeyboardSearch:function(e,r,t,a){this.inherited(arguments),e&&(-1==a||e.popup&&1==a)&&this.onItemClick(e,r)},_keyboardSearchCompare:function(e,r){return e.shortcutKey?r==e.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(e){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,e);else{var r=this._getTopMenu();r&&r._isMenuBar&&r.focusNext()}},_onPopupHover:function(){this.set("selected",this.currentPopupItem),this._stopPendingCloseTimer()},onItemHover:function(e){this.activated?(this.set("selected",e),!e.popup||e.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(e)},this.popupDelay))):this.passivePopupDelay<1/0&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(e,{type:"click"})},this.passivePopupDelay)),this._hoveredChild=e,e._set("hovering",!0)},_onChildDeselect:function(e){this._stopPopupTimer(),this.currentPopupItem==e&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this._pendingClose_timer=null,this.currentPopupItem=null,e._closePopup()},this.popupDelay))},onItemUnhover:function(e){this._hoveredChild==e&&(this._hoveredChild=null),this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null),e._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var e=this;e.parentMenu;e=e.parentMenu);return e},onItemClick:function(e,r){if(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.focusChild(e),e.disabled)return!1;if(e.popup){this.set("selected",e),this.set("activated",!0);var t=/^key/.test(r._origType||r.type)||0==r.clientX&&0==r.clientY;this._openItemPopup(e,t)}else this.onExecute(),e._onClick?e._onClick(r):e.onClick(r)},_openItemPopup:function(e,r){if(e!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup()),this._stopPopupTimer();var t=e.popup;t.parentMenu=this,this.own(this._mouseoverHandle=o.once(t.domNode,"mouseover",d.hitch(this,"_onPopupHover")));var a=this;e._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){r&&a.focusChild(e),a._cleanUp()},onExecute:d.hitch(this,"_cleanUp",!0),onClose:function(){a._mouseoverHandle&&(a._mouseoverHandle.remove(),delete a._mouseoverHandle)}},r),this.currentPopupItem=e}},onOpen:function(){this.isShowingNow=!0,this.set("activated",!0)},onClose:function(){this.set("activated",!1),this.set("selected",null),this.isShowingNow=!1,this.parentMenu=null},_closeChild:function(){this._stopPopupTimer(),this.currentPopupItem&&(this.focused&&(a.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(e){this._hoveredChild&&this._hoveredChild!=e&&this.onItemUnhover(this._hoveredChild),this.set("selected",e)},_onBlur:function(){this._cleanUp(!0),this.inherited(arguments)},_cleanUp:function(e){this._closeChild(),void 0===this.isShowingNow&&this.set("activated",!1),e&&this.set("selected",null)}})});//# sourceMappingURL=_MenuBase.js.map