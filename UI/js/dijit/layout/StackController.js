//>>built
define("dijit/layout/StackController",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/keys","dojo/_base/lang","dojo/on","dojo/topic","../focus","../registry","../_Widget","../_TemplatedMixin","../_Container","../form/ToggleButton","dojo/touch"],function(e,t,r,a,i,d,l,o,n,s,f,m,u,h){var v=t("dijit.layout._StackButton",h,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(e){this.inherited(arguments),(this.focusNode||this.domNode).setAttribute("role","tab")}}),y=t("dijit.layout.StackController",[f,m,u],{baseClass:"dijitStackController",templateString:"<span role='tablist' data-dojo-attach-event='onkeydown'></span>",containerId:"",buttonWidget:v,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(e){return s.byId(this.id+"_"+e)},postCreate:function(){this.inherited(arguments),this.own(o.subscribe(this.containerId+"-startup",d.hitch(this,"onStartup")),o.subscribe(this.containerId+"-addChild",d.hitch(this,"onAddChild")),o.subscribe(this.containerId+"-removeChild",d.hitch(this,"onRemoveChild")),o.subscribe(this.containerId+"-selectChild",d.hitch(this,"onSelectChild")),o.subscribe(this.containerId+"-containerKeyDown",d.hitch(this,"onContainerKeyDown"))),this.containerNode.dojoClick=!0,this.own(l(this.containerNode,"click",d.hitch(this,function(e){var t=s.getEnclosingWidget(e.target);if(t!=this.containerNode&&!t.disabled&&t.page)for(var a=e.target;a!==this.containerNode;a=a.parentNode){if(r.contains(a,this.buttonWidgetCloseClass)){this.onCloseButtonClick(t.page);break}if(a==t.domNode){this.onButtonClick(t.page);break}}})))},onStartup:function(t){this.textDir=t.textDir,e.forEach(t.children,this.onAddChild,this),t.selected&&this.onSelectChild(t.selected);var r=s.byId(this.containerId).containerNode,a=d.hitch(this,"pane2button"),i={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"},o=function(e,t){return l(r,"attrmodified-"+e,function(e){var r=a(e.detail&&e.detail.widget&&e.detail.widget.id);r&&r.set(t,e.detail.newValue)})};for(var n in i)this.own(o(n,i[n]))},destroy:function(e){this.destroyDescendants(e),this.inherited(arguments)},onAddChild:function(e,t){var r=d.isString(this.buttonWidget)?d.getObject(this.buttonWidget):this.buttonWidget,a=new r({id:this.id+"_"+e.id,name:this.id+"_"+e.id,label:e.title,disabled:e.disabled,ownerDocument:this.ownerDocument,dir:e.dir,lang:e.lang,textDir:e.textDir||this.textDir,showLabel:e.showTitle,iconClass:e.iconClass,closeButton:e.closable,title:e.tooltip,page:e});this.addChild(a,t),e.controlButton=a,this._currentChild||this.onSelectChild(e);var i=e._wrapper.getAttribute("aria-labelledby")?e._wrapper.getAttribute("aria-labelledby")+" "+a.id:a.id;e._wrapper.removeAttribute("aria-label"),e._wrapper.setAttribute("aria-labelledby",i)},onRemoveChild:function(e){this._currentChild===e&&(this._currentChild=null);var t=this.pane2button(e.id);t&&(this.removeChild(t),t.destroy()),delete e.controlButton},onSelectChild:function(e){if(e){if(this._currentChild){var t=this.pane2button(this._currentChild.id);t.set("checked",!1),t.focusNode.setAttribute("tabIndex","-1")}var r=this.pane2button(e.id);r.set("checked",!0),this._currentChild=e,r.focusNode.setAttribute("tabIndex","0");s.byId(this.containerId)}},onButtonClick:function(e){var t=this.pane2button(e.id);n.focus(t.focusNode),this._currentChild&&this._currentChild.id===e.id&&t.set("checked",!0),s.byId(this.containerId).selectChild(e)},onCloseButtonClick:function(e){if(s.byId(this.containerId).closeChild(e),this._currentChild){var t=this.pane2button(this._currentChild.id);t&&n.focus(t.focusNode||t.domNode)}},adjacent:function(t){this.isLeftToRight()||this.tabPosition&&!/top|bottom/.test(this.tabPosition)||(t=!t);var r,a=this.getChildren(),i=e.indexOf(a,this.pane2button(this._currentChild.id)),d=a[i];do{i=(i+(t?1:a.length-1))%a.length,r=a[i]}while(r.disabled&&r!=d);return r},onkeydown:function(e,t){if(!this.disabled&&!e.altKey){var r=null;if(e.ctrlKey||!e._djpage){switch(e.keyCode){case i.LEFT_ARROW:case i.UP_ARROW:e._djpage||(r=!1);break;case i.PAGE_UP:e.ctrlKey&&(r=!1);break;case i.RIGHT_ARROW:case i.DOWN_ARROW:e._djpage||(r=!0);break;case i.PAGE_DOWN:e.ctrlKey&&(r=!0);break;case i.HOME:for(var a=this.getChildren(),d=0;d<a.length;d++){var l=a[d];if(!l.disabled){this.onButtonClick(l.page);break}}e.stopPropagation(),e.preventDefault();break;case i.END:for(var a=this.getChildren(),d=a.length-1;d>=0;d--){var l=a[d];if(!l.disabled){this.onButtonClick(l.page);break}}e.stopPropagation(),e.preventDefault();break;case i.DELETE:case"W".charCodeAt(0):this._currentChild.closable&&(e.keyCode==i.DELETE||e.ctrlKey)&&(this.onCloseButtonClick(this._currentChild),e.stopPropagation(),e.preventDefault());break;case i.TAB:e.ctrlKey&&(this.onButtonClick(this.adjacent(!e.shiftKey).page),e.stopPropagation(),e.preventDefault())}null!==r&&(this.onButtonClick(this.adjacent(r).page),e.stopPropagation(),e.preventDefault())}}},onContainerKeyDown:function(e){e.e._djpage=e.page,this.onkeydown(e.e)}});return y.StackButton=v,y});//# sourceMappingURL=StackController.js.map