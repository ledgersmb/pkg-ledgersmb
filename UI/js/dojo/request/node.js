//>>built
define("dojo/request/node",["require","./util","./handlers","../errors/RequestTimeoutError","../node!http","../node!https","../node!url","../node!stream"],function(e,r,a,t,i,d,l,o){function n(e,o){var n=r.parseArgs(e,r.deepCreate(m,o),o&&o.data instanceof f);e=n.url,o=n.options;var s=r.deferred(n,function(e,r){r.clientRequest.abort()});e=l.parse(e);var v=n.requestOptions={hostname:e.hostname,port:e.port,socketPath:o.socketPath,method:o.method,headers:o.headers,agent:o.agent,pfx:o.pfx,key:o.key,passphrase:o.passphrase,cert:o.cert,ca:o.ca,ciphers:o.ciphers,rejectUnauthorized:!1!==o.rejectUnauthorized};e.path&&(v.path=e.path),(o.user||o.password)&&(v.auth=(o.user||"")+":"+(o.password||""));var u=n.clientRequest=("https:"===e.protocol?d:i).request(v);if(o.socketOptions&&("timeout"in o.socketOptions&&u.setTimeout(o.socketOptions.timeout),"noDelay"in o.socketOptions&&u.setNoDelay(o.socketOptions.noDelay),"keepAlive"in o.socketOptions)){var h=o.socketOptions.keepAlive;u.setKeepAlive(h>=0,h||0)}if(u.on("socket",function(){n.hasSocket=!0,s.progress(n)}),u.on("response",function(e){n.clientResponse=e,n.status=e.statusCode,n.getHeader=function(r){return e.headers[r.toLowerCase()]||null};var t=[];e.on("data",function(e){t.push(e)}),e.on("end",function(){y&&clearTimeout(y),n.text=t.join(""),r.checkStatus(n.status)||s.reject({message:"http response code "+n.status,response:n});try{a(n),s.resolve(n)}catch(e){s.reject(e)}})}),u.on("error",s.reject),o.data?"string"==typeof o.data?u.end(o.data):o.data.pipe(u):u.end(),o.timeout)var y=setTimeout(function(){s.cancel(new t(n))},o.timeout);return s.promise}var s,f=o.Stream,m={method:"GET",query:null,data:s,headers:{}};return r.addCommonMethods(n),n});//# sourceMappingURL=node.js.map