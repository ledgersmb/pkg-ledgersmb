//>>built
define("dojo/Deferred",["./has","./_base/lang","./errors/CancelError","./promise/Promise","require"],function(e,r,n,t,i){"use strict";var s=0,o=1,u=2,f="This deferred has already been fulfilled.",c=Object.freeze||function(){},a=function(e,r,n,t,i){for(var s=0;s<e.length;s++)l(e[s],r,n,t)},l=function(e,r,n,t){var i=e[r],f=e.deferred;if(i)try{var c=i(n);if(r===s)void 0!==c&&d(f,r,c);else{if(c&&"function"==typeof c.then)return e.cancel=c.cancel,void c.then(h(f,o),h(f,u),h(f,s));d(f,o,c)}}catch(e){d(f,u,e)}else d(f,r,n)},h=function(e,r){return function(n){d(e,r,n)}},d=function(e,r,n){if(!e.isCanceled())switch(r){case s:e.progress(n);break;case o:e.resolve(n);break;case u:e.reject(n)}},p=function(e){var r,i,h,d=this.promise=new t,v=this,w=!1,g=[];this.isResolved=d.isResolved=function(){return r===o},this.isRejected=d.isRejected=function(){return r===u},this.isFulfilled=d.isFulfilled=function(){return!!r},this.isCanceled=d.isCanceled=function(){return w},this.progress=function(e,n){if(r){if(!0===n)throw new Error(f);return d}return a(g,s,e,null,v),d},this.resolve=function(e,n){if(r){if(!0===n)throw new Error(f);return d}return a(g,r=o,i=e,null,v),g=null,d};var y=this.reject=function(e,n){if(r){if(!0===n)throw new Error(f);return d}return a(g,r=u,i=e,h,v),g=null,d};this.then=d.then=function(e,n,t){var s=[t,e,n];return s.cancel=d.cancel,s.deferred=new p(function(e){return s.cancel&&s.cancel(e)}),r&&!g?l(s,r,i,h):g.push(s),s.deferred.promise},this.cancel=d.cancel=function(t,s){if(r){if(!0===s)throw new Error(f)}else{if(e){var o=e(t);t=void 0===o?t:o}if(w=!0,!r)return void 0===t&&(t=new n),y(t),t;if(r===u&&i===t)return t}},c(d)};return p.prototype.toString=function(){return"[object Deferred]"},i&&i(p),p});//# sourceMappingURL=Deferred.js.map