//>>built
define("dojo/_base/connect",["./kernel","../on","../topic","../aspect","./event","../mouse","./sniff","./lang","../keys"],function(e,t,n,r,o,i,a,s){function c(n,o,a,c,u){if(c=s.hitch(a,c),!n||!n.addEventListener&&!n.attachEvent)return r.after(n||e.global,o,c,!0);if("string"==typeof o&&"on"==o.substring(0,2)&&(o=o.substring(2)),n||(n=e.global),!u)switch(o){case"keypress":o=d;break;case"mouseenter":o=i.enter;break;case"mouseleave":o=i.leave}return t(n,o,c,u)}function u(e){e.keyChar=e.charCode?String.fromCharCode(e.charCode):"",e.charOrCode=e.keyChar||e.keyCode}a.add("events-keypress-typed",function(){var e={charCode:0};try{e=document.createEvent("KeyboardEvent"),(e.initKeyboardEvent||e.initKeyEvent).call(e,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(e){}return 0==e.charCode&&!a("opera")});var d,l={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},f=a("mac")?"metaKey":"ctrlKey",h=function(e,t){var n=s.mixin({},e,t);return u(n),n.preventDefault=function(){e.preventDefault()},n.stopPropagation=function(){e.stopPropagation()},n};if(a("events-keypress-typed")){var p=function(e,t){try{return e.keyCode=t}catch(e){return 0}};d=function(e,n){var r=t(e,"keydown",function(e){var t=e.keyCode,r=13!=t&&32!=t&&(27!=t||!a("ie"))&&(t<48||t>90)&&(t<96||t>111)&&(t<186||t>192)&&(t<219||t>222)&&229!=t;if(r||e.ctrlKey){var o=r?0:t;if(e.ctrlKey){if(3==t||13==t)return n.call(e.currentTarget,e);o>95&&o<106?o-=48:!e.shiftKey&&o>=65&&o<=90?o+=32:o=l[o]||o}var i=h(e,{type:"keypress",faux:!0,charCode:o});n.call(e.currentTarget,i),a("ie")&&p(e,i.keyCode)}}),o=t(e,"keypress",function(e){var t=e.charCode;return t=t>=32?t:0,e=h(e,{charCode:t,faux:!0}),n.call(this,e)});return{remove:function(){r.remove(),o.remove()}}}}else d=a("opera")?function(e,n){return t(e,"keypress",function(e){var t=e.which;return 3==t&&(t=99),t=t<32&&!e.shiftKey?0:t,e.ctrlKey&&!e.shiftKey&&t>=65&&t<=90&&(t+=32),n.call(this,h(e,{charCode:t}))})}:function(e,n){return t(e,"keypress",function(e){return u(e),n.call(this,e)})};var g={_keypress:d,connect:function(e,t,n,r,o){var i=arguments,a=[],s=0;a.push("string"==typeof i[0]?null:i[s++],i[s++]);var u=i[s+1];a.push("string"==typeof u||"function"==typeof u?i[s++]:null,i[s++]);for(var d=i.length;s<d;s++)a.push(i[s]);return c.apply(this,a)},disconnect:function(e){e&&e.remove()},subscribe:function(e,t,r){return n.subscribe(e,s.hitch(t,r))},publish:function(e,t){return n.publish.apply(n,[e].concat(t))},connectPublisher:function(e,t,n){var r=function(){g.publish(e,arguments)};return n?g.connect(t,n,r):g.connect(t,r)},isCopyKey:function(e){return e[f]}};return g.unsubscribe=g.disconnect,s.mixin(e,g),g});//# sourceMappingURL=connect.js.map